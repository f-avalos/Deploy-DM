# Heart Attack Prediction - Deploy DM

## ğŸ“‹ DescripciÃ³n

AplicaciÃ³n web de predicciÃ³n de ataques al corazÃ³n utilizando Machine Learning. La aplicaciÃ³n utiliza Flask como backend y una interfaz web moderna y responsiva para interactuar con el modelo de predicciÃ³n.

## ğŸš€ CaracterÃ­sticas Principales

### âœ¨ Interfaz Web Mejorada
- **DiseÃ±o moderno y responsivo** con Bootstrap 5
- **Interfaz unificada** - CombinaciÃ³n de templates en un solo archivo
- **Experiencia de usuario mejorada** con animaciones y feedback visual
- **ValidaciÃ³n en tiempo real** de formularios
- **Indicadores de carga** y estados de la aplicaciÃ³n
- **DiseÃ±o gradient** con efectos visuales atractivos
- **Iconos Font Awesome** para mejor UX

### ğŸ”§ Backend Robusto
- **Logging completo** para monitoreo y debugging
- **ValidaciÃ³n de datos exhaustiva** con mensajes de error especÃ­ficos
- **Manejo de errores mejorado** con cÃ³digos de estado HTTP apropiados
- **API REST bien estructurada** con mÃºltiples endpoints
- **Health checks** para monitoreo del sistema
- **Contador de predicciones** y estadÃ­sticas
- **InformaciÃ³n detallada del modelo** cargado

### ğŸ“Š Funcionalidades de PredicciÃ³n
- **6 caracterÃ­sticas de entrada**:
  - Actividades FÃ­sicas
  - Consumo de Alcohol
  - CategorÃ­a de Edad (18-44, 45-64, 65+)
  - Estado de Fumador
  - Estado de Diabetes
  - Historial de Ataques Previos
- **PredicciÃ³n binaria** (Alto/Bajo riesgo)
- **Probabilidades** cuando el modelo las soporta
- **Recomendaciones personalizadas** segÃºn el resultado

## ğŸ› ï¸ InstalaciÃ³n y ConfiguraciÃ³n

### Requisitos Previos
- Python 3.8+
- pip

### Pasos de InstalaciÃ³n

1. **Clonar/Descargar el proyecto**
   ```bash
   cd Deploy-DM
   ```

2. **Crear entorno virtual (recomendado)**
   ```bash
   python -m venv venv
   
   # Windows
   venv\Scripts\activate
   
   # Linux/Mac
   source venv/bin/activate
   ```

3. **Instalar dependencias**
   ```bash
   pip install -r requirements.txt
   ```

4. **Configurar variables de entorno (opcional para desarrollo local)**
   ```bash
   # Copiar el archivo de ejemplo
   cp .env.example .env
   
   # Editar .env segÃºn necesidades
   ```

5. **Verificar modelo**
   - AsegÃºrese de que `best_model.pkl` estÃ© en el directorio raÃ­z
   - El modelo debe ser compatible con scikit-learn

6. **Ejecutar la aplicaciÃ³n**
   ```bash
   python main.py
   ```

7. **Acceder a la aplicaciÃ³n**
   - Abrir navegador web en: `http://127.0.0.1:5000`

## ğŸš€ Despliegue en Render

### PreparaciÃ³n para Despliegue

El proyecto incluye todos los archivos necesarios para el despliegue en Render:

- `Procfile` - Comando de inicio para Render
- `runtime.txt` - VersiÃ³n de Python
- `requirements.txt` - Dependencias (incluye gunicorn)
- `RENDER_DEPLOYMENT.md` - GuÃ­a detallada de despliegue

### Variables de Entorno para Render

Configure las siguientes variables de entorno en su dashboard de Render:

| Variable | Valor | DescripciÃ³n |
|----------|-------|-------------|
| `FLASK_ENV` | `production` | Modo de Flask |
| `FLASK_DEBUG` | `false` | Desactiva debug en producciÃ³n |
| `MODEL_PATH` | `best_model.pkl` | Ruta del modelo ML |

### Pasos de Despliegue

1. **Subir cÃ³digo a GitHub/GitLab**
2. **Conectar repositorio a Render**
3. **Configurar variables de entorno**
4. **Establecer comandos de construcciÃ³n e inicio**:
   - Build Command: `pip install -r requirements.txt`
   - Start Command: `gunicorn main:app --host=0.0.0.0 --port=$PORT`

Para mÃ¡s detalles, consulte `RENDER_DEPLOYMENT.md`.

## ğŸ“¡ API Endpoints

### ğŸ  Frontend
- `GET /` - PÃ¡gina principal de la aplicaciÃ³n
- `GET /index` - Alias para la pÃ¡gina principal

### ğŸ” InformaciÃ³n del Sistema
- `GET /api/data` - InformaciÃ³n general del sistema
- `GET /health` - Estado de salud del servicio
- `GET /model-info` - InformaciÃ³n detallada del modelo ML

### ğŸ¤– PredicciÃ³n
- `POST /predict` - Realizar predicciÃ³n

#### Ejemplo de uso del endpoint de predicciÃ³n:

```javascript
// Datos de entrada
{
  "PhysicalActivities": "1",      // 0=No, 1=SÃ­
  "AlcoholDrinkers": "0",         // 0=No, 1=SÃ­
  "ageCategoryGrouped": "1",      // 0=18-44, 1=45-64, 2=65+
  "SmokerStatusGrouped": "0",     // 0=Nunca, 1=Ex-fumador, 2=Actual
  "HadDiabetesGrouped": "0",      // 0=No, 1=SÃ­, 2=Prediabetes
  "HadHeartAttack": "0"           // 0=No, 1=SÃ­
}

// Respuesta exitosa
{
  "prediction": 0,
  "result": "Bajo riesgo de ataque al corazÃ³n",
  "probability_no_attack": 0.85,
  "probability_attack": 0.15,
  "status": "success",
  "timestamp": "2025-01-14T10:30:00",
  "input_features": { ... }
}
```

## ğŸ§ª Testing

### Test AutomÃ¡tico
Ejecutar el script de pruebas:
```bash
# Con el servidor corriendo en otra terminal
python test_app.py
```

### Test Manual
1. Completar el formulario en la interfaz web
2. Verificar que todos los campos sean obligatorios
3. Probar con diferentes combinaciones de valores
4. Verificar que las probabilidades se muestren correctamente

## ğŸ“ Estructura del Proyecto

```
Deploy-DM/
â”œâ”€â”€ main.py                    # AplicaciÃ³n Flask principal
â”œâ”€â”€ best_model.pkl            # Modelo de ML entrenado
â”œâ”€â”€ test_app.py               # Script de pruebas
â”œâ”€â”€ requirements.txt          # Dependencias Python (actualizado)
â”œâ”€â”€ Procfile                  # Comando de inicio para Render
â”œâ”€â”€ runtime.txt               # VersiÃ³n de Python para Render
â”œâ”€â”€ .env.example              # Variables de entorno de ejemplo
â”œâ”€â”€ .gitignore                # Archivos a ignorar en Git
â”œâ”€â”€ README.md                 # DocumentaciÃ³n
â”œâ”€â”€ RENDER_DEPLOYMENT.md      # GuÃ­a de despliegue
â”œâ”€â”€ templates/
â”‚   â””â”€â”€ app.html             # Template unificado (HTML + CSS + JS)
â””â”€â”€ __pycache__/             # Cache de Python
```

## ğŸ”§ Mejoras Implementadas

### ğŸ¨ Frontend
- **UnificaciÃ³n de templates**: `index.html` y `content.html` combinados en `app.html`
- **DiseÃ±o responsivo**: Compatible con dispositivos mÃ³viles
- **UI moderna**: Gradientes, animaciones, iconos
- **ValidaciÃ³n mejorada**: Feedback visual en tiempo real
- **Loading states**: Indicadores de carga durante las peticiones
- **Modal de informaciÃ³n**: Detalles del modelo cargado

### âš™ï¸ Backend
- **Logging estructurado**: Mensajes informativos y de error
- **ValidaciÃ³n robusta**: VerificaciÃ³n de tipos y rangos de datos
- **Error handling**: Manejo apropiado de excepciones
- **Health monitoring**: Endpoints para verificar estado del sistema
- **API documentation**: Respuestas JSON bien estructuradas
- **Performance tracking**: Contador de predicciones realizadas

### ğŸ”’ Seguridad y Robustez
- **ValidaciÃ³n de entrada**: VerificaciÃ³n de todos los parÃ¡metros
- **Error messages**: Mensajes de error informativos sin exponer detalles internos
- **Status codes**: CÃ³digos HTTP apropiados para cada situaciÃ³n
- **Input sanitization**: Limpieza y validaciÃ³n de datos de entrada

## ğŸš¨ Troubleshooting

### Problemas Comunes

1. **Error al cargar el modelo**
   ```
   ERROR: No se pudo cargar el modelo
   ```
   - Verificar que `best_model.pkl` existe
   - Verificar compatibilidad de versiones de scikit-learn

2. **Error de conexiÃ³n en el frontend**
   ```
   Error de conexiÃ³n: Failed to fetch
   ```
   - Verificar que Flask estÃ© ejecutÃ¡ndose
   - Verificar que no haya conflictos de puerto

3. **Advertencia de versiÃ³n de scikit-learn**
   ```
   InconsistentVersionWarning
   ```
   - Es una advertencia, no afecta la funcionalidad
   - Para eliminarla, entrenar el modelo con la versiÃ³n actual

### Logs de Debug
Los logs se muestran en la consola donde se ejecuta `main.py`. Niveles de log:
- `INFO`: Operaciones normales
- `ERROR`: Errores que requieren atenciÃ³n
- `WARNING`: Situaciones que pueden requerir revisiÃ³n

## ğŸ“ˆ PrÃ³ximas Mejoras

- [ ] AutenticaciÃ³n de usuarios
- [ ] Historial de predicciones
- [ ] Exportar resultados a PDF
- [ ] Dashboard de estadÃ­sticas
- [ ] API rate limiting
- [ ] ContainerizaciÃ³n con Docker
- [ ] Tests unitarios automatizados

## ğŸ“ Licencia

Este proyecto es de uso educativo y de demostraciÃ³n.

## ğŸ‘¥ ContribuciÃ³n

Para contribuir al proyecto:
1. Fork el repositorio
2. Crear una rama para la nueva funcionalidad
3. Realizar los cambios
4. Ejecutar las pruebas
5. Crear un Pull Request

---

**Desarrollado con â¤ï¸ para Deploy DM**